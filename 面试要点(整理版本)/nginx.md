### 什么是负载均衡呢

通俗些讲，就是我们有几十台、几百台甚至更多服务器，将这些服务器组成一个服务器集群，当客户端访问某台设备的数据时，首先发送的请求先到一台中间服务器，并通过中间服务器在服务器集群中平均分摊到其他服务器中，因此，当用户每次所发送的请求都将会保证服务器集群中的设备均与平摊，以此来分担服务器的压力，从而保持服务器集群的整理性能最优，避免出现有崩溃的现象。


### Nginx负载均衡的作用

- 转发功能
    Nginx 会按照一定的算法轮询、权重将客户端发来的请求转发至不同的应用服务器上，同时减轻单台服务器的压力，提高服务器的并发量；

- 故障迁移
    当一台服务器出现了故障时，客户端发来的请求将自动发送到其他服务器

- 添加恢复
    当故障服务器恢复正常工作时，将自动添加到处理用户请求中；

- ip_hash
每个请求按访问 IP 的hash结果分配，每个访客固定访问一个后端服务器

- fair（第三方）
按后端服务器的响应时间来分配请求，响应时间短的优先分配。

- url_hash（第三方）
按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存时比较有效。

### nginx负载均衡的几种策略方式

- 轮询（默认）

客户端发出的每个请求将按照时间顺序逐一分配到不同的后端服务器，如后端服务器down掉，能自动剔除。

- weight

weight 代表权重，默认为1，权重越高被分配的客户端也就越多。

```
upstream backserver {
    server 192.168.1.10 weight=3;
    server 192.168.1.11 weight=7;
}
```


正向代理：

隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都由代理服务器代替来请求。
「正向代理」指一对一或多对一，Server 不知道请求的 Client 都是哪些人。

反向代理：

反向代理一般是负载均衡的一个原理。

反向代理隐藏了真实的服务端，当我们请求 http://www.baidu.com 的时候，就像拨打 QQ 客服热线一样，背后可能有成千上万台服务器为我们服务，但具体是哪一台，你不知道，也不需要知道，你只需要知道反向代理服务器是谁就好了，http://www.baidu.com 就是我们的反向代理服务器，反向代理服务器会帮我们把请求转发到真实的服务器那里去。


两者的区别在于代理的对象不一样：正向代理代理的对象是客户端，反向代理代理的对象是服务端。


